% 动力学测试用
% Get aircraft parameters from sys_params
params = sys_params();

% Example inputs
state = [10, 0, -1, 0, 0, 0, 10, 0, -1,10, 0, -1,10];  % m/s (ground speed)

% 旋翼悬停平衡计算测试 参考Media--TTR_arm_a
%% 偏航plan A
arm_a = 0;
arm_b = -arm_a;
% tc = (params.mass * params.gravity * 1/3) / (params.T_max * cos(params.arm_c));
tc = (1/3) / cos(params.arm_c);
ta = (params.l1/params.l2) * tc * cos(params.arm_c);
tb = ta;


%% 偏航plan B
% tc = 1/3 ;
% arm_a = atan2(params.k_f, params.l3);
% arm_b = -arm_a;
% % ta = (tc * params.k_f) / ( 2 * params.l3 * sin(arm_a));
% ta = tc / (2 * cos(arm_a));
% tb = ta;

command = struct('elevon_l', 0.1, 'elevon_r', -0.1, 'throttle_a', ta, 'throttle_b', tb,'throttle_c', tc, 'arm_a', arm_a, 'arm_b', arm_b);

% Call the function to calculate aerodynamic forces and moments
[force, moment] = all_forces_moments(state, command, params);


% 重力
Fg = params.mass * params.gravity;


% Display the results
disp('Forces:');
disp(force);

disp('Moments:');
disp(moment);

disp('Fg:');
disp(Fg);


% 创建一个图形窗口并设置名称
fig = figure('name', 'arm_a calculation reference', 'NumberTitle', 'off');
% figure;
% 在窗口中显示图像
imshow('E:\documents\Codes\codes\matlab\6_DOF_formation\3-D+tilt_trirotor+Control\TTR_sim_init_xuan_A\Medias\TTR_arm_a.jpg'); % Load the image (ensure the file path is correct)
title('神的笔记');